<html>
<head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.63.3/codemirror.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.1/katex.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/4.18.2/antd.compact.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<div style="margin:30px 30px 0 0"><div style="margin-bottom:15px"><b>Kernel:</b> <!-- -->Python (ds_env)</div><div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h1 id="who-is-ready-to-learn?-our-machines-are"><span>Who is ready to learn? (Our Machines Are!)</span></h1><p><span>Our task at hand -- building an AI that can save lives.</span></p><p><span>Today we are going to work to create an AI that can predict whether a breast cancer tumor is benign or malignant. This diagnosis has incredibly important medical implications for those who are diagnosed with breast cancer. </span></p><p><span>Before we get started, you should make sure you know what the difference between benign and malignant tumors are and discuss them with your team.</span></p><p><span><strong>Hint:</strong></span><span> we recommend you heavily refer to your EDA mini project from last week for this activity! </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="step-1-imports-and-preprocessing"><span>Step 1: Imports and Preprocessing</span></h3><p><span>We need to </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">import pandas as pd</code></span><span> and read in our data. It is currently a .csv (comma-separated value) file, and we generally use the pd.read_csv() function from pandas to read our data into a dataframe.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">import</span><span> </span><span class="cm-variable">pandas</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">pd</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">numpy</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">np</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">breast_cancer</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">read_csv</span><span>(</span><span class="cm-string">&quot;https://raw.githubusercontent.com/pkmklong/Breast-Cancer-Wisconsin-Diagnostic-DataSet/master/data.csv&quot;</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>TODO:</strong></span><span> Do you remember how to print the first five rows of a pandas dataframe? How about all of the columns? How about the number of rows? Please do that below and google anything you are unsure about. </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># print first five rows of breast_cancer</span><span>
</span><span class="cm-variable">breast_cancer</span><span>.</span><span class="cm-variable">head</span><span>(</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># print columns of breast_cancer</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># print the number of rows in breast_cancer</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># explore anything else you are interested in here</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>TODO:</strong></span><span> Can you figure out how many rows are malignant (M) and how many are benign (B)? </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Figure out how many rows are malignant and how many are benign. Hint: use the .count() function!</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="step-2-do-your-research"><span>Step 2: Do Your Research</span></h3><p><span>That is a ton of columns. That is a ton of data! Where do we start? </span></p><p><span>You should probably do some research on this dataset to find out what the columns mean. I got it on kaggle - you can read about it here: </span><a href="https://www.kaggle.com/datasets/uciml/breast-cancer-wisconsin-data" target="_blank" rel="noopener"><span>Wisconsin Breast Cancer Dataset</span></a><span>.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="step-3-cleaning-our-data-up"><span>Step 3: Cleaning our data up!</span></h3><p><span>Maybe there are some columns we don&#x27;t need. The last column makes zero sense right? Do we need an id column for our purposes? You should drop </span><span><strong>any</strong></span><span> columns that you feel are not worth keeping track of. </span></p><p><span>Pandas&#x27; </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">drop()</code></span><span> documentation: </span><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html" target="_blank" rel="noopener"><span>https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html</span></a><span>. Remember to use </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">inplace = True</code></span><span> if you are changing your dataframe and note creating a new one!</span></p><p><span><strong>Note:</strong></span><span> This data is pretty clean! We only need a few lines for this dataset.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># use df.drop to drop Unnamed: 32 and ID, as well as any columns you don&#x27;t think we should keep track of.</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># drop any n/a values remaining! Remember inplace!</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># print the last five rows of your dataframe </span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>TODO:</strong></span><span> at this point, all of our data should be numeric except for our diagnosis column. This is because supervised machine learning models work off of numerical data. Use breast_cancer.info() below to check that all our data besides &#x27;diagnosis&#x27; are numeric.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Run breast_cancer.info()</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="dummy-variables---preprocessing"><span>Dummy Variables - Preprocessing</span></h3><p><span>Our target variable (the variable we are trying to predict) is </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">diagnosis</code></span><span>. Our only problem is that the diagnosis variable will either be an &#x27;M&#x27; or a &#x27;B&#x27;, which is not something our model will understand. We need to change our M&#x27;s to 1&#x27;s and B&#x27;s to 0&#x27;s so that our model can think like computers do -- using numbers!</span></p><p><span>To do so, we use something called a dummy variable. I&#x27;ll show you how to do so below. </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">dummies</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">get_dummies</span><span>(</span><span class="cm-variable">breast_cancer</span><span>[</span><span class="cm-string">&quot;diagnosis&quot;</span><span>]</span><span>)</span><span>
</span><span class="cm-variable">dummies</span><span>.</span><span class="cm-variable">head</span><span>(</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>Ok, we&#x27;ve got our dummy variables. What now?</strong></span><span> Now we have to pick one and add it to our dataframe -- we also have to delete the old diagnosis column!</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">breast_cancer</span><span>[</span><span class="cm-string">&quot;outcome&quot;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">dummies</span><span>[</span><span class="cm-string">&quot;M&quot;</span><span>]</span><span>
</span><span class="cm-variable">breast_cancer</span><span>.</span><span class="cm-variable">head</span><span>(</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>TODO:</strong></span><span> Now that our outcome column is there, we need to remove the diagnosis column that had the bad data, right? Please do so below.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#Drop the &#x27;diagnosis&#x27; column from your dataframe. Remember to use inplace if you are changing the dataframe itself!</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="visualize-our-data"><span>Visualize our data</span></h3><p><span>Now that we&#x27;ve cleaned our data and it is all ready for our model, we should understand some of the relationships. Use your learnings from last week to create two plots -- you can always start with simple </span><a href="https://plotly.com/python/line-and-scatter/" target="_blank" rel="noopener"><span>scatter plots</span></a><span> or maybe a </span><a href="https://plotly.com/python/splom/" target="_blank" rel="noopener"><span>scatterplot matrix</span></a><span>. Get creative!</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">import</span><span> </span><span class="cm-variable">plotly</span><span>.</span><span class="cm-variable">express</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">px</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">numpy</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">matplotlib</span><span>.</span><span class="cm-variable">pyplot</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">plt</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">seaborn</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">sns</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Visualization 1 here</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Visualization 2 here</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="are-you-ready-to-perform-machine-learning?-"><span>Are you ready to perform machine learning? </span></h3><p><span>Do you think deciding whether a tumor is benign or malignant is classification or regression? Talk with your team for a minute.</span></p><p><span>Either way, we need to tell our code what our target variable is, and what our input is going to be. </span><div style="display:inline"><div><br/></div></div><span> </span><span><strong>TODO:</strong></span><span> Can you do so below?</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Create a variable named target and set it equal to the [&quot;outcome&quot;] column in our breast_cancer dataframe.</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Create a variable named input_columns and set it equal to breast_cancer.loc[:, breast_cancer.columns != &quot;outcome&quot;]. This means our inputs are every single column except for column!</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="splitting-the-data"><span>Splitting the Data</span></h3><p><span>For every single supervised machine learning problem, we will follow the same flow with </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">sklearn</code></span><span>:</span></p><blockquote><p><span><em>Split, Fit, Predict, and Evaluate.</em></span></p></blockquote><p><span>What is first? Splitting our data into training and testing sets. You can watch a video on why we do that </span><a href="https://www.youtube.com/watch?v=_vdMKioCXqQ" target="_blank" rel="noopener"><span>in the first 36 seconds of this video</span></a><span>. </span></p><p><span>We will split our data using the </span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" target="_blank" rel="noopener"><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">train_test_split()</code></span></a><span> function on </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">sklearn</code></span><span> using the same flow as this tutorial: </span><a href="https://realpython.com/train-test-split-python-data/#application-of-train_test_split" target="_blank" rel="noopener"><span>https://realpython.com/train-test-split-python-data/#application-of-train_test_split</span></a><span>. The code to do so is below. </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">import</span><span> </span><span class="cm-variable">sklearn</span><span>
</span><span class="cm-keyword">from</span><span> </span><span class="cm-variable">sklearn</span><span>.</span><span class="cm-variable">model_selection</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">train_test_split</span><span>
</span><span>
</span><span class="cm-variable">x_train</span><span>,</span><span> </span><span class="cm-variable">x_test</span><span>,</span><span> </span><span class="cm-variable">y_train</span><span>,</span><span> </span><span class="cm-variable">y_test</span><span> </span><span>=</span><span> </span><span class="cm-variable">train_test_split</span><span>(</span><span class="cm-variable">input_columns</span><span>,</span><span> </span><span class="cm-variable">target</span><span>,</span><span> </span><span class="cm-variable">test_size</span><span>=</span><span class="cm-number">0.2</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>TODO:</strong></span><span> can you look at the shape of the x_train, x_test, y_train, and y_test columns? Why does the shape of these columns make sense? </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#hint: start with x_train.shape</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>TODO:</strong></span><span> Can you print the outputs with print(y_train) and print(y_test)? What do these 1&#x27;s and 0&#x27;s represent?</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#print outputs</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="we-have-split-now-we-gotta-fit"><span>We have split, now we gotta fit!</span></h3><p><span>Now that are data is preprocessed (all numerical), and split (80/20 train/test) for machine learning, we can create a model to </span><span><strong>classify</strong></span><span> whether a patient has malignant (1) or benign (0) breast cancer!</span></p><p><span>The first model is a classification model called K Nearest Neighbors. You can watch a video on how K Nearest Neighbors works here: </span><a href="https://www.youtube.com/watch?v=0p0o5cmgLdE" target="_blank" rel="noopener"><span>https://www.youtube.com/watch?v=0p0o5cmgLdE</span></a><span>.</span></p><p><span>First things first, we need to import our model using SKLearn. You can follow the </span><a href="https://scikit-learn.org/stable/auto_examples/neighbors/plot_classification.html#sphx-glr-auto-examples-neighbors-plot-classification-py" target="_blank" rel="noopener"><span>guide</span></a><span> here to see how this tutorial works.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">import</span><span> </span><span class="cm-variable">sklearn</span><span> </span><span class="cm-comment">#our favorite machine learning library</span><span>
</span><span class="cm-keyword">from</span><span> </span><span class="cm-variable">sklearn</span><span>.</span><span class="cm-variable">neighbors</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">KNeighborsClassifier</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">KNN</span><span> </span><span class="cm-comment">#this will import our model as KNN</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>Creating the model object:</strong></span><span>  we need to create an instance of the model. This is like having a model and giving it a nickname so we can remember it, change it, and save it to work custom on our dataset. </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Creating the KNN model object -- we need to tell it the number of neighbors to look at.</span><span>
</span><span class="cm-variable">k</span><span> </span><span>=</span><span> </span><span class="cm-number">7</span><span> </span><span class="cm-comment">#number of neighbors to look at (look at 7 nearest neighbors)</span><span>
</span><span class="cm-variable">my_KNN_model</span><span> </span><span>=</span><span> </span><span class="cm-variable">KNN</span><span>(</span><span class="cm-variable">n_neighbors</span><span>=</span><span class="cm-variable">k</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span>And there you have it. We have a K Nearest Neighbors model that will look at the 7 nearest neighbors, and gave it a nice nickname, my_KNN_model. </span><div style="display:inline"><div><br/></div></div><span> </span><div style="display:inline"><div><br/></div></div><span></span></p><p><span><strong>Fitting (Training) the model object:</strong></span><span> </span><span><strong>Supervised machine learning</strong></span><span> training involves learning from past results (</span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_train</code></span><span>) and past inputs (</span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">x_train</code></span><span>). We pass these to our model for learning to teach our model to answer the question &quot;</span><span><em>based on these inputs, what outputs can we expect?</em></span><span>&quot;</span><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span></span></p><p><span>To do this, we want to let this model learn from our data. We do so by running our model object&#x27;s </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">.fit()</code></span><span> function on our training data.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">my_KNN_model</span><span>.</span><span class="cm-variable">fit</span><span>(</span><span class="cm-variable">x_train</span><span>,</span><span> </span><span class="cm-variable">y_train</span><span>)</span><span> </span><span class="cm-comment">#train the model on our past results x_train (inputs) and y_train (outputs)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>Prediction and Evaluation:</strong></span><span> How do we know if our model is actually good? We need to </span><span><strong>test</strong></span><span> our model by giving it a two-step quiz. </span></p><p><span>Step 1: We let our model use our testing inputs (</span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">x_test</code></span><span>) to make predictions that guess the whether the patient has benign or malignant tumors (we call these predictions </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_hat</code></span><span>). In this case our </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_hat</code></span><span>&#x27;s are a bunch of 1&#x27;s and 0&#x27;s that represent whether our model thinks the patient&#x27;s tumor is benign or malignant. </span></p><p><span>We do this by running our model object&#x27;s </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">.predict()</code></span><span> function.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#make some predictions based on your testing inputs (x_test) using the predict() function</span><span>
</span><span class="cm-variable">y_hat</span><span> </span><span>=</span><span> </span><span class="cm-variable">my_KNN_model</span><span>.</span><span class="cm-variable">predict</span><span>(</span><span class="cm-variable">x_test</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">y_hat</span><span> </span><span class="cm-comment">#these are our predictions for our x_test inputs. </span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">np</span><span>.</span><span class="cm-variable">array</span><span>(</span><span class="cm-variable">y_test</span><span>)</span><span> </span><span class="cm-comment">#these are what actually happened for our x_test inputs. Do you see some differences?</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span>Step 2 - Evaluation: Here we want to compare </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_hat</code></span><span> to </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_test</code></span><span>. Discuss with your team about why we should do this. </span></p><p><span>One we we can compare them is visual inspection. With that said, would you recommend going through by hand and making a tally for every time the one&#x27;s and zero&#x27;s don&#x27;t match up?</span></p><p><span>Please don&#x27;t do this. Please save yourself this nasty headache when we can just do math. Below is a common way to do this, called mean squared error. </span></p><p><span>To get mean squared error, we compute the difference between each element in </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_hat</code></span><span> and </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_test</code></span><span> and square it and then get the average of all of that to see how far off we are.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">total_squared_error</span><span> </span><span>=</span><span> </span><span>(</span><span class="cm-variable">np</span><span>.</span><span class="cm-builtin">sum</span><span>(</span><span>(</span><span class="cm-variable">y_test</span><span> </span><span class="cm-operator">-</span><span> </span><span class="cm-variable">y_hat</span><span>)</span><span class="cm-operator">**</span><span class="cm-number">2</span><span>)</span><span>)</span><span> </span><span class="cm-comment">#get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))</span><span>
</span><span class="cm-variable">mean_squared_error</span><span> </span><span>=</span><span> </span><span class="cm-variable">total_squared_error</span><span class="cm-operator">/</span><span class="cm-builtin">len</span><span>(</span><span class="cm-variable">y_test</span><span>)</span><span> </span><span class="cm-comment">#divide this by how many rows/observations we have </span><span>
</span><span class="cm-keyword">print</span><span>(</span><span class="cm-variable">mean_squared_error</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>Not too bad!</strong></span><span> MSE represents  the average error (difference) between our model and the correct result. A low mean squared error means that our model makes the correct guess most of the time. </span></p><p><span>But we have to think about the nature of the problem. As Data Scientists, do we want to tell someone that we have this average error when we are predicting something as serious as breast cancer? </span></p><p><span>And what does an error mean? Are we telling them they don&#x27;t have a malignant tumor (y_hat=0) when they actually do (y_test = 1)? Are we telling them they have a tumor (y_hat=1) when they actually don&#x27;t (y_test = 0)?</span></p><p><span>We can get insights on this through a confusion matrix. </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">from</span><span> </span><span class="cm-variable">sklearn</span><span>.</span><span class="cm-variable">metrics</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">confusion_matrix</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">seaborn</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">sns</span><span>
</span><span class="cm-variable">sns</span><span>.</span><span class="cm-variable">heatmap</span><span>(</span><span class="cm-variable">confusion_matrix</span><span>(</span><span class="cm-variable">y_test</span><span>,</span><span> </span><span class="cm-variable">y_hat</span><span>)</span><span>,</span><span> </span><span class="cm-variable">annot</span><span>=</span><span class="cm-builtin">True</span><span>,</span><span> </span><span class="cm-variable">fmt</span><span>=</span><span class="cm-string">&#x27;g&#x27;</span><span>)</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>What is this???</strong></span><span> I encourage you and your team to read about it here: </span><a href="https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62" target="_blank" rel="noopener"><span>https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62</span></a><span>. You should define what true positives, true negatives, false positives, and false negatives represent for this scenario. </span></p><p><span>Discuss what other  findings you can take away, and talk with your instructor about metrics like accuracy, precision and recall!</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span><strong>The last step!!</strong></span><span> We need to change parameters and data to improve our model as we go. If we can make even 1 more correct cancer prediction, it is worth it, right? </span></p><p><span><strong>TODO:</strong></span><span> Go back and change the value of </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">k</code></span><span> in the </span><span><strong>creating your model object</strong></span><span> section and re-run all the code below it. See what changes with your MSE and confusion matrix!</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="code-your-own-machine-learning-model"><span>Code Your Own Machine Learning Model</span></h3><p><span>It&#x27;s time for us to create our own classifier. Let&#x27;s go with an </span><a href="https://www.youtube.com/watch?v=_YPScrckx28" target="_blank" rel="noopener"><span>SVM</span></a><span>. We will do the first step for you.</span></p><p><span>I know it was a lot of information in the last section, but the code is </span><span><em>basically</em></span><span> the same. Since our data is already split, you will follow the same steps to fit your model, make some predictions, evaluate the performance, and visualize your confusion matrix.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">from</span><span> </span><span class="cm-variable">sklearn</span><span>.</span><span class="cm-variable">svm</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">SVC</span><span>
</span><span class="cm-comment">#Create your model object -- you can go back and change the kernel argument after evaluating your data.</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span>Do you remember how to fit a model? What parts of our data do we fit/train on? You can go look at the section above for inspiration.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#fit your model</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span>Now create some predictions and set them equal to </span><span><code style="padding:.2em .4em;margin:0;font-size:85%;border-radius:6px">y_hat</code></span><span>. You can look above or google how to make predictions on sklearn if you get confused!</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#create some predictions on your testing inputs and set them equal to y_hat.</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span>Compute your MSE below. Is this higher or lower than KNN? Which one would you recommend so far?</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#Compute your MSE.</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span>Now, create a confusion matrix! How are the results? Do we end up with more false negatives or false positives?</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#Create a confusion matrix</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><p><span>Amazing, now try changing your kernel and seeing how your results change. You can research what kernels are available here: </span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html" target="_blank" rel="noopener"><span>https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html</span></a><span>. If your interested in more ML with SKLearn you should get used to pages like these!</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="want-more?"><span>Want more?</span></h3><p><span>There are dozens of models available on SKLearn: </span><a href="https://scikit-learn.org/stable/supervised_learning.html" target="_blank" rel="noopener"><span>https://scikit-learn.org/stable/supervised_learning.html</span></a><span>.</span></p><p><span>You can try an implement your own below, I recommend starting with logistic regression or random forests </span><span>😃</span><span> </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">#have fun!</span><span>
</span></div></pre></div></div><div></div></div></div></div>
</body>
